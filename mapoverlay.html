<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Fortnite Drop Map Overlay</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: black;
      width: 100%;
      height: 100%;
      overflow: hidden;
    }

    #map-container {
      position: relative;
      width: 100%;
      height: 100%;
    }

    #map {
      position: absolute;
      width: 50%;
      height: 50%;
      object-fit: contain;
      transform-origin: center center;
      transition: transform 0.8s ease;
    }

    #marker {
      position: absolute;
      width: 40px;
      height: 40px;
      background: red;
      border-radius: 50%;
      transform: translate(-50%, -50%);
      z-index: 10;
      pointer-events: none;
    }
  </style>
</head>
<body>
  <div id="map-container">
    <img id="map" src="https://fortnite-api.com/images/map.png" alt="Fortnite Map"/>
    <div id="marker" style="display: none;"></div>
  </div>

  <script>
    let pois = [];

    // Load POI data on startup
    fetch("https://fortnite-api.com/v1/map")
      .then(res => res.json())
      .then(data => {
        pois = data.data.pois;
      });

    function zoomToLocation(locationName) {
      const map = document.getElementById("map");
      const marker = document.getElementById("marker");

      const poi = pois.find(p => p.name === locationName);
      if (!poi) return;

      // Fortnite map is 2048x2048
      const mapSize = 2048;
      const containerSize = 1080;

      const centerX = (poi.location.x / mapSize) * 100;
      const centerY = (poi.location.y / mapSize) * 100;

      // Position marker
      marker.style.left = `${centerX}%`;
      marker.style.top = `${centerY}%`;
      marker.style.display = "block";

      // Zoom effect using CSS transform
      const offsetX = (containerSize / 2 - (poi.location.x / mapSize) * containerSize);
      const offsetY = (containerSize / 2 - (poi.location.y / mapSize) * containerSize);

      map.style.transform = `scale(2) translate(${offsetX}px, ${offsetY}px)`;
    }

    // Listen for postMessage from LumiaStream
    window.addEventListener("message", (event) => {
      const { type, location } = event.data;
      if (type === "setLocation") {
        zoomToLocation(location);
      }
    });
  </script>
</body>
</html>
